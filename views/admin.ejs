<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>HyghByte Admin</title>

  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/admin.css">
</head>

<body class="admin-page">

<div class="admin-wrapper">

  <div class="admin-card">
      <h2>Adaugă joc</h2>

      <% if (error) { %>
          <div class="error-box"><%= error %></div>
      <% } %>

      <form action="/addGame" method="POST" class="admin-form">

          <!-- SELECT PLATFORM -->
          <div class="form-group">
              <label>Sursa:</label>
              <select name="source" id="sourceSelect" onchange="toggleFields()">
                  <option value="steam">Steam (ID automat)</option>
                  <option value="itch">itch.io (manual)</option>
              </select>
          </div>

          <!-- STEAM SECTION -->
          <div id="steamFields">
              <div class="form-group">
                  <label>Steam ID:</label>
                  <input type="text" name="steamId" placeholder="Ex: 730">
              </div>
          </div>

          <!-- ITCH.IO SECTION -->
          <div id="itchFields" style="display:none;">

              <div class="form-group">
                  <label>Titlu:</label>
                  <input type="text" name="title" placeholder="Titlu joc">
              </div>

              <div class="form-group">
                  <label>Genuri:</label>
                  <input type="text" name="genres" placeholder="Horror, Shooter etc">
              </div>

              <div class="form-group">
                  <label>Link joc itch.io:</label>
                  <input type="text" name="itchLink" placeholder="https://nume.itch.io/jocul">
              </div>

              <div class="form-group">
                  <label>Imagine (URL):</label>
                  <input type="text" name="imageUrl" placeholder="https://link-la-poza.png">
              </div>

          </div>

          <button class="admin-btn">Adaugă joc</button>
      </form>
  </div>


  <!-- ======================= GAME LIST ======================= -->

  <div class="admin-card">
      <h2>Lista jocuri</h2>

      <form action="/updateFeatured" method="POST">

          <div class="admin-games-grid">

              <% games.forEach(g => { %>

                  <div class="admin-game-card">

                      <% if (g.imageUrl) { %>
                          <img src="<%= g.imageUrl %>">
                      <% } else { %>
                          <div class="agc-placeholder">Nu are imagine</div>
                      <% } %>

                      <div class="agc-info">
                          <h3><%= g.title %></h3>
                          <p><%= g.genres %></p>
                      </div>

                      <label class="admin-check">
                          <input 
                              type="checkbox"
                              name="featured"
                              value="<%= g.id %>"
                              <%= g.featured ? "checked" : "" %>>
                          Featured
                      </label>

                      <form action="/deleteGame/<%= g.id %>" method="POST">
                          <button class="btn-delete">Șterge</button>
                      </form>

                  </div>

              <% }) %>

          </div>

          <button class="admin-btn" style="margin-top:20px;">Salvează Featured</button>

      </form>
  </div>

</div>

<script>
function toggleFields() {
    const src = document.getElementById("sourceSelect").value;

    document.getElementById("steamFields").style.display =
        src === "steam" ? "block" : "none";

    document.getElementById("itchFields").style.display =
        src === "itch" ? "block" : "none";
}
</script>

</body>
</html>
