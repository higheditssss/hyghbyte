<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel — HYGHBYTE</title>
  <link rel="stylesheet" href="/styles.css">
</head>

<body class="admin-page">

<div class="admin-wrapper">

  <div class="admin-card">
    <h2>Adaugă joc</h2>

    <% if (error) { %>
      <p style="color:#ff4d6d;"><%= error %></p>
    <% } %>

    <form class="admin-form" action="/addGame" method="POST">

      <label>Source</label>
      <select name="source" onchange="toggleInputs(this.value)">
        <option value="steam">Steam</option>
        <option value="itch">itch.io</option>
        <option value="manual">Manual</option>
      </select>

      <div id="steamField">
        <label>Steam App ID</label>
        <input type="text" name="steamId" placeholder="Ex: 730">
      </div>

      <div id="itchField" style="display:none;">
        <label>itch.io Link</label>
        <input type="text" name="itchLink" placeholder="https://itch.io/...">
      </div>

      <div id="manualFields" style="display:none;">
        <label>Titlu</label>
        <input type="text" name="title">

        <label>Genres</label>
        <input type="text" name="genres">

        <label>Imagine</label>
        <input type="text" name="imageUrl">

        <label>Play URL</label>
        <input type="text" name="playUrl">
      </div>

      <button class="admin-btn">Adaugă joc</button>
    </form>

  </div>

  <div class="admin-card">
    <h2>Jocuri</h2>

    <form action="/updateFeatured" method="POST">
      <div class="admin-games-grid">

        <% games.forEach(g => { %>
          <div class="admin-game-card">
            <% if (g.imageurl) { %>
              <img src="<%= g.imageurl %>">
            <% } else { %>
              <div class="agc-placeholder">No Image</div>
            <% } %>

            <div class="agc-info">
              <h3><%= g.title %></h3>
              <p><%= g.genres %></p>
            </div>

            <div class="admin-check">
              <label>Featured</label>
              <input type="checkbox" name="featured" value="<%= g.id %>" <%= g.featured ? "checked" : "" %>>
            </div>

            <form action="/deleteGame/<%= g.id %>" method="POST">
              <button style="width:100%;padding:10px;margin-top:10px;background:#ff355c;border:none;color:white;border-radius:8px;">Șterge</button>
            </form>

          </div>
        <% }) %>

      </div>

      <button class="admin-btn">Salvează Featured</button>
    </form>

  </div>

</div>

<script>
function toggleInputs(src) {
  document.getElementById("steamField").style.display = src === "steam" ? "block" : "none";
  document.getElementById("itchField").style.display = src === "itch" ? "block" : "none";
  document.getElementById("manualFields").style.display = src === "manual" ? "block" : "none";
}
</script>

</body>
</html>
