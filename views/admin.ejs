<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>HyghByte Admin</title>

  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/admin.css">
</head>

<body class="admin-page">

<div class="admin-wrapper">

  <!-- ADD GAME PANEL -->
  <div class="admin-card">
      <h2>Adaugă joc</h2>

      <% if (error) { %>
          <div class="error-box"><%= error %></div>
      <% } %>

      <form action="/addGame" method="POST" class="admin-form">

          <!-- SELECT SOURCE -->
          <div class="form-group">
              <label>Sursă joc:</label>
              <select name="source" id="sourceSelect" onchange="toggleFields()">
                  <option value="steam">Steam (doar ID)</option>
                  <option value="itch">itch.io (manual)</option>
              </select>
          </div>

          <!-- STEAM ONLY INPUT -->
          <div id="steamFields">
              <label>Steam App ID:</label>
              <input type="text" name="steamId" placeholder="Ex: 730">
          </div>

          <!-- ITCH.IO INPUTS -->
          <div id="itchFields" style="display:none;">
              <label>Titlu:</label>
              <input type="text" name="title" placeholder="Titlu joc">

              <label>Genuri:</label>
              <input type="text" name="genres" placeholder="Adventure, Horror etc">

              <label>Link joc itch.io:</label>
              <input type="text" name="itchLink" placeholder="https://nume.itch.io/jocul-tau">

              <label>Imagine (URL):</label>
              <input type="text" name="imageUrl" placeholder="https://link-poza.png">
          </div>

          <!-- BADGE SELECTOR -->
          <label>Tip joc (badge):</label>
          <select name="gameType">
              <option value="free">FREE</option>
              <option value="paid">PAID</option>
              <option value="demo">DEMO</option>
              <option value="comingsoon">COMING SOON</option>
          </select>

          <button class="admin-btn">Adaugă joc</button>
      </form>
  </div>


  <!-- GAME LIST -->
  <div class="admin-card">
      <h2>Lista jocuri</h2>

      <form action="/updateFeatured" method="POST">

          <div class="admin-games-grid">

              <% games.forEach(g => { %>
                  <div class="admin-game-card">

                      <% if (g.imageUrl) { %>
                          <img src="<%= g.imageUrl %>">
                      <% } else { %>
                          <div class="agc-placeholder">Fără imagine</div>
                      <% } %>

                      <div class="agc-info">
                          <h3><%= g.title %></h3>
                          <p><%= g.genres %></p>

                          <% if (g.gametype) { %>
                            <span class="badge-admin <%= g.gametype %>"><%= g.gametype.toUpperCase() %></span>
                          <% } %>
                      </div>

                      <label class="admin-check">
                          <input type="checkbox" 
                                 name="featured"
                                 value="<%= g.id %>"
                                 <%= g.featured == 1 ? "checked" : "" %>>
                          Featured
                      </label>

                      <form action="/deleteGame/<%= g.id %>" method="POST">
                          <button class="btn-delete">Șterge</button>
                      </form>

                  </div>
              <% }) %>

          </div>

          <button class="admin-btn" style="margin-top:20px;">Salvează Featured</button>

      </form>
  </div>

</div>

<script>
function toggleFields() {
    const src = document.getElementById("sourceSelect").value;

    document.getElementById("steamFields").style.display =
        src === "steam" ? "block" : "none";

    document.getElementById("itchFields").style.display =
        src === "itch" ? "block" : "none";
}
</script>

</body>
</html>
