<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>HYGHBYTE // Game Vault</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css" />
</head>

<body>

<header class="hb-header">
  <div>
    <span class="hb-logo-main">HYGHBYTE</span>
    <span class="hb-logo-sub">GAME VAULT</span>
  </div>

  <div class="hb-header-right">
    <a href="https://highstatss.vercel.app/" target="_blank" class="hb-kick-btn">HIGHSTATS</a>
    <button id="caseBtn" class="hb-random-btn">üéÅ Open Case</button>
  </div>
</header>

<main class="hb-main">

  <!-- ======================= FEATURED SLIDER ======================= -->
  <section class="featured-section">
    <h2 class="featured-title">Featured Games</h2>

    <div class="featured-slider">
      <button id="featured-prev" class="featured-arrow left">‚ùÆ</button>

      <div id="featured-container">
        <% featuredGames.forEach((g, index) => { %>
          <div class="featured-slide <%= index === 0 ? 'active' : '' %>"
               style="--bg:url('<%= g.featuredimage || g.imageurl %>')">

            <img src="<%= g.featuredimage || g.imageurl %>" class="featured-big-img">

            <div class="featured-right">
              <h3><%= g.title %></h3>

              <% if (g.genres) { %>
                <p class="featured-genres"><%= g.genres %></p>
              <% } %>

              <a href="<%= g.playurl %>" class="featured-play-btn" target="_blank">
                ‚ñ∂ JoacƒÉ acum
              </a>
            </div>
          </div>
        <% }) %>
      </div>

      <button id="featured-next" class="featured-arrow right">‚ùØ</button>
    </div>
  </section>


  <!-- ======================= LAYOUT (SIDEBAR + GRID) ======================= -->
  <div class="hb-layout">

    <aside class="hb-sidebar">
      <div class="hb-sidebar-title">Library</div>

      <button class="hb-sidebar-item is-active" data-filter="all">
        <span class="hb-sidebar-dot all"></span> Toate jocurile
      </button>

      <button class="hb-sidebar-item" data-filter="steam">
        <span class="hb-sidebar-dot steam"></span> Steam
      </button>

      <button class="hb-sidebar-item" data-filter="itch">
        <span class="hb-sidebar-dot itch"></span> itch.io
      </button>
    </aside>


    <!-- ======================= GAME GRID ======================= -->
    <section class="hb-content">
      <div class="hb-grid">

        <% games.forEach(g => { %>
          <article class="hb-card" data-source="<%= g.source %>">
            <div class="hb-card-image-wrap">
              <img src="<%= g.imageurl %>" class="hb-card-image">
            </div>

            <div class="hb-card-body">
              <h3 class="hb-card-title"><%= g.title %></h3>

              <% if (g.genres) { %>
                <p class="hb-card-genres"><%= g.genres %></p>
              <% } %>

              <div class="hb-card-bottom">
                <a href="<%= g.playurl %>" target="_blank" class="hb-button-primary">
                  ‚ñ∂ JoacƒÉ
                </a>

                <% if (g.source === 'steam') { %>
                  <img src="https://upload.wikimedia.org/wikipedia/commons/8/83/Steam_icon_logo.svg"
                       class="hb-source-icon">
                <% } else if (g.source === 'itch') { %>
                  <img src="https://static-00.iconduck.com/assets.00/itch-io-icon-2048x2048-7q3p8x7n.png"
                       class="hb-source-icon">
                <% } %>
              </div>
            </div>
          </article>
        <% }) %>

      </div>
    </section>

  </div>

</main>

<footer class="hb-footer">
  HYGHBYTE 2025 ‚Äî Not affiliated with Steam or itch.io.
</footer>


<!-- ======================= CASE OPENING POPUP ======================= -->
<div id="casePopup" class="case-popup hidden">
  <div class="case-strip-container">
    <div id="caseStrip" class="case-strip"></div>
  </div>
</div>


<!-- ======================= FEATURED SLIDER JS ======================= -->
<script>
  const slides = document.querySelectorAll(".featured-slide");
  let fIndex = 0;

  function showSlide(i) {
    slides.forEach(s => s.classList.remove("active"));
    slides[i].classList.add("active");
  }

  document.getElementById("featured-prev").onclick = () => {
    fIndex = (fIndex - 1 + slides.length) % slides.length;
    showSlide(fIndex);
  };

  document.getElementById("featured-next").onclick = () => {
    fIndex = (fIndex + 1) % slides.length;
    showSlide(fIndex);
  };
</script>


<!-- ======================= CASE OPENING LOGIC ======================= -->
<script>
const allGames = <%- JSON.stringify(games) %>;
const caseBtn = document.getElementById("caseBtn");

function openCase() {
  if (!allGames.length) return;

  const popup = document.getElementById("casePopup");
  const strip = document.getElementById("caseStrip");

  popup.classList.remove("hidden");
  strip.innerHTML = "";

  // Generate scrolling items
  const rollList = [];
  for (let i = 0; i < 60; i++) {
    const g = allGames[Math.floor(Math.random() * allGames.length)];
    rollList.push(g);

    const img = document.createElement("img");
    img.src = g.imageurl;
    strip.appendChild(img);
  }

  const winner = rollList[rollList.length - 1];

  const size = 230 + 12;
  const move = (rollList.length - 4) * size;

  strip.style.transition = "transform 3s cubic-bezier(0.1, 0.7, 0.2, 1)";
  strip.style.transform = `translateX(-${move}px)`;

  setTimeout(() => {
    window.location.href = winner.playurl;
  }, 3000);
}

caseBtn.onclick = openCase;
</script>


</body>
</html>
