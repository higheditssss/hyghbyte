<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>HYGHBYTE // Game Vault</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css" />
</head>

<body>

<header class="hb-header">
  <div>
    <span class="hb-logo-main">HYGHBYTE</span>
    <span class="hb-logo-sub">BETA</span>
  </div>

  <div class="hb-header-right">
    <a href="https://highstatss.vercel.app/" target="_blank" class="hb-kick-btn">HIGHSTATS</a>
    <button id="caseBtn" class="hb-random-btn">RANDOM GAME</button>
  </div>
</header>

<main class="hb-main">

  <!-- üîç SEARCH BAR (nou adƒÉugat) -->
  <div class="hb-search-container">
    <input id="searchInput" type="text" placeholder="CautƒÉ un joc..." class="hb-search-input">
  </div>

  <!-- FEATURED SLIDER -->
  <section class="featured-section">
    <h2 class="featured-title">UURMEAZA..</h2>

    <% if (featuredGames.length === 0) { %>
      <p style="opacity:.7; font-size:14px;">IN CURAND.</p>
    <% } else { %>

    <div class="featured-slider">
      <button id="featured-prev" class="featured-arrow left">‚ùÆ</button>

      <div id="featured-container">
        <% featuredGames.forEach((g, idx) => { %>
          <div class="featured-slide <%= idx === 0 ? 'active' : '' %>"
               style="--bg:url('<%= g.imageUrl %>')">

            <img src="<%= g.imageUrl %>" class="featured-big-img">

            <div class="featured-right">
              <h3><%= g.title %></h3>

              <% if (g.badge) { %>
                <span class="popup-badge <%= g.badge.toLowerCase() %>">
                  <%= g.badge.toUpperCase() %>
                </span>
              <% } %>

              <% if (g.genres) { %>
                <p class="featured-genres"><%= g.genres %></p>
              <% } %>

              <a href="<%= g.playUrl %>" class="featured-play-btn" target="_blank">
                ‚ñ∂ JoacƒÉ acum
              </a>
            </div>
          </div>
        <% }) %>
      </div>

      <button id="featured-next" class="featured-arrow right">‚ùØ</button>
    </div>

    <% } %>
  </section>

  <!-- GAME GRID (fƒÉrƒÉ sidebar!) -->
  <section class="hb-content">
    <div class="hb-grid">

      <% games.forEach(g => { %>
      <article class="hb-card" data-source="<%= g.source %>" data-title="<%= g.title.toLowerCase() %>" data-genres="<%= g.genres.toLowerCase() %>">

        <% if (g.badge) { %>
          <div class="game-badge-overlay badge-<%= g.badge.toLowerCase() %>">
            <%= g.badge.toUpperCase() %>
          </div>
        <% } %>

        <div class="hb-card-image-wrap">
          <img src="<%= g.imageUrl %>" class="hb-card-image">
        </div>

        <div class="hb-card-body">
          <h3 class="hb-card-title"><%= g.title %></h3>

          <% if (g.genres) { %>
            <p class="hb-card-genres"><%= g.genres %></p>
          <% } %>

          <div class="hb-card-bottom">
            <a href="<%= g.playUrl %>" target="_blank" class="hb-button-primary">‚ñ∂ JoacƒÉ</a>

            <% if (g.source === 'steam') { %>
              <img src="https://upload.wikimedia.org/wikipedia/commons/8/83/Steam_icon_logo.svg" class="hb-source-icon">
            <% } else { %>
              <img src="https://img.icons8.com/ios11/600/FA5252/itch-io.png" class="hb-source-icon">
            <% } %>
          </div>
        </div>
      </article>
      <% }) %>

    </div>
  </section>

</main>

<footer class="hb-footer">
  HYGHBYTE 2025 ‚Äî Not affiliated with Steam or itch.io.
</footer>

<!-- FEATURED SCRIPT -->
<script>
const slides = document.querySelectorAll(".featured-slide");
let index = 0;
function showSlide(i) {
  slides.forEach(s => s.classList.remove("active"));
  slides[i].classList.add("active");
}
if (slides.length > 0) {
  document.getElementById("featured-prev").onclick = () => {
    index = (index - 1 + slides.length) % slides.length;
    showSlide(index);
  };
  document.getElementById("featured-next").onclick = () => {
    index = (index + 1) % slides.length;
    showSlide(index);
  };
}
</script>

<!-- SEARCH SCRIPT -->
<script>
document.getElementById("searchInput").addEventListener("input", e => {
  const text = e.target.value.toLowerCase();

  document.querySelectorAll(".hb-card").forEach(card => {
    const title = card.dataset.title;
    const genres = card.dataset.genres;

    card.style.display =
      title.includes(text) || genres.includes(text)
      ? "block"
      : "none";
  });
});
</script>

<!-- RANDOM GAME POPUP -->
<script>
const allGames = <%- JSON.stringify(games) %>;
const caseBtn = document.getElementById("caseBtn");

function openCase() {
  if (!allGames.length) return;

  const g = allGames[Math.floor(Math.random() * allGames.length)];

  document.getElementById("popup-title").innerText = g.title;
  document.getElementById("popup-genres").innerText = g.genres || "";
  document.getElementById("popup-img").src = g.imageUrl;
  document.getElementById("popup-play").href = g.playUrl;

  document.getElementById("popup-bg").style.backgroundImage = `url('${g.imageUrl}')`;

  document.getElementById("gamePopup").classList.remove("hidden");
}

function closePopup() {
  document.getElementById("gamePopup").classList.add("hidden");
}

caseBtn.addEventListener("click", openCase);
</script>

<!-- POPUP HTML -->
<div id="gamePopup" class="popup hidden">
  <div id="popup-bg" class="popup-bg"></div>

  <div class="popup-content">
    <img id="popup-img" class="popup-img">
    <h2 id="popup-title" class="popup-title"></h2>
    <p id="popup-genres" class="popup-genres"></p>

    <a id="popup-play" class="popup-play-btn" target="_blank">‚ñ∂ JoacƒÉ</a>
    <button onclick="closePopup()" class="popup-close-btn">√énchide</button>
  </div>
</div>

</body>
</html>
